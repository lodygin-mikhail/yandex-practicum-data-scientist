# Определение стоимости автомобилей

## Описание проекта
Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Вам нужно построить модель для определения стоимости.

## Навыки и инструменты
Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

Описание данных:

- `DateCrawled` — дата скачивания анкеты из базы
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л. с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была машина в ремонте или нет
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий автомобиля
- `PostalCode` — почтовый индекс владельца анкеты (пользователя)
- `LastSeen` — дата последней активности пользователя

Целью исследования является разработка модели машинного обучения , которая сможет предсказать рыночную стоимость автомобиля на основе технических характеристиках, комплектации и других признаков.

## Общий вывод
В ходе работы была разработана и протестирована модель для прогнозирования рыночной стоимости автомобилей. Наилучшие результаты продемонстрировал **градиентный бустинг (LGBMRegressor)** с параметрами `max_depth=10` и `random_state=42`:

- **RMSE на тренировочных данных: 1728.910 евро**

- **RMSE на тестовых данных: 1733.645 евро**

Несмотря на высокую точность, LightGBM требует **больше времени на обучение**, что может быть критично для реального использования в приложении.

**Сравнение моделей**
1. LightGBM

    - **Плюсы:** Лучшее качество (наименьший RMSE).

    - **Минусы:** Дольше обучается.


2. LinearRegression

    - **Плюсы:** Самая быстрая модель (минимальное время предсказания).

    - **Минусы:** Низкая точность (RMSE выше на ~15-20%).


3. DecisionTreeRegressor

    - **Плюсы:** Компромисс между скоростью и качеством.

    - **Минусы:** Уступает LightGBM в точности, но работает значительно быстрее.

**Выбор оптимальной модели**

Исходя из требований заказчика (баланс между точностью и скоростью), **выбрана модель DecisionTreeRegressor** с параметрами `max_depth=12` и `random_state=42`. Её результаты:

- **RMSE на тестовых данных: 1895.896 евро** (приемлемая точность для MVP).

- **Время предсказания: В 3-5 раз быстрее LightGBM**, что критично для работы в реальном времени.

**Анализ значимости признаков**

С помощью **SHAP-значений** определены ключевые факторы, влияющие на стоимость автомобиля:

1. **Год регистрации** (наибольшая важность).

2. **Мощность двигателя (л.с.)**.

3. **Бренд и модель автомобиля**.

4. **Пробег**.

**Рекомендации**

Для первой версии приложения использовать DecisionTreeRegressor — оптимальное сочетание скорости и точности.

В будущем можно доработать модель, внедрив LightGBM с оптимизированными гиперпараметрами, если позволит инфраструктура.