# Создание модели МО отбора коров для покупки

[HTML](https://github.com/lodygin-mikhail/yandex-practicum-data-scientist/blob/main/Car%20cost%20estimation/Project%206.html)     [ipynb](https://github.com/lodygin-mikhail/yandex-practicum-data-scientist/blob/main/Car%20cost%20estimation/Project%206.ipynb)

## Описание проекта
Вы работаете в IT-компании, которая выполняет на заказ проекты по машинному обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!

Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:
1. Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
2. Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).

С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

Описание данных:
- `id` — уникальный идентификатор коровы.
- `Удой, кг` — масса молока, которую корова даёт в год (в килограммах).
- `ЭКЕ (Энергетическая кормовая единица)` — показатель питательности корма коровы.
- `Сырой протеин, г` — содержание сырого протеина в корме (в граммах).
- `СПО (Сахаро-протеиновое соотношение)` — отношение сахара к протеину в корме коровы.
- `Порода` — порода коровы.
- `Тип пастбища` — ландшафт лугов, на которых паслась корова.
- `порода папы_быка` — порода папы коровы.
- `Жирность,%` — содержание жиров в молоке (в процентах).
- `Белок,%` — содержание белков в молоке (в процентах).
- `Вкус молока` — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно).
- `Возраст` — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).
- `Имя Папы` — имя папы коровы.

Целью работы является разработка модели машинного обучения определения коров, соответствующим критериям, для их покупки.

Исследование разделим на этапы:
- Знакомство с данными
- Предобработка данных
- Исследовательский анализ данных
- Корреляционный анализ
- Обучение модели линейной регрессии
- Обучение модели логистической регрессии

## Навыки и инструменты

- pandas
- numpy
- scikit-learn
- matplotlib
- seaborn
- scipy
- phik
- shap

## Общий вывод
Таким образом, в результате выполнения данной работы, были получены следующие результаты:

1. В датасетах df_ferma и df_cow_buy были проведены следующие операции: переименование столбцов, приведение типов данных к плавающей точке, удаление дубликатов, переименование значений в столбцах и форматирование значений;


2. По построенным диаграммам рассеяния с признаком «Удой, кг» был сделан вывод о взаимосвязи между удоем и различными факторами. Коровы старшего возраста и те, что пасутся на холмистых пастбищах, обычно имеют более высокий удой. Коровы с вкусным молоком и породой отца Айдиал также могут давать больше молока. Уровень удоя имеет высокую положительную корреляцию с сахаро-протеиновым отношением, энергетической ценностью корма и содержанием жира в молоке. Также было определено зависимость удоя от энергетической ценности корма имеет нелинейный вид;


3. Были построены три модели линейной регрессии с последовательным улучшением качества предсказаний. Модели демонстрировали высокую объясняющую способность удоя молока, однако анализ остатков выявил нелинейности, требующие дополнительного внимания. Полученное значение коэффициента детерминации R2 третьей модели - 0,846. Прогнозы модели позволяют фермеру принимать обоснованные решения о покупке коров, минимизируя риски приобретения менее продуктивных особей;


4. Была построена модель логистической регрессии. Несмотря на значение Precision равное 1, что и нужно было в данной задаче, accuracy модели всего 0,439, что говорит о том, что модель предсказывает верные значения только в 43,9% случаев. Для доработки моедли в будущем необходимо найти более сбалансированный порог классификации, который будет учитывать как Precision, так и Recall. Это может быть сделано с помощью кривой Precision-Recall и выбора точки, которая соответствует желаемому балансу. Применение модели для предсказания вкуса молока коров, которые планируется купить, предоставляет фермеру дополнительную информацию для обоснованного выбора;


5. Результаты работы моделей показывают, что из представленного стада на продажу фермер может выбрать одну корову, которая соответствуют двум ключевым критериям: удой более 6000 кг в год и вкусное молоко.